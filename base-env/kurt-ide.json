{
  "init": {},
  "guest": {
    "cpu_kind": "shared",
    "cpus": 8,
    "memory_mb": 16384
  },
  "mounts": [
    {
      "volume": "vol_r6pw8w3zypxk6zjv",
      "path": "/dev/fly_vol"
    }
  ],
  "image": "registry.fly.io/flynet-ide:deployment-01JT2EP6M8RFSYBEYXSC6H0KAH", 
  "containers": [
    {
      "name": "storage",
      "image": "docker.io/flyio/app-storage:latest",
      "command": [
        "/usr/local/bin/mount.sh"
      ],
      "mounts": [
        {
          "name": "shared",
          "path": "/data"
        }
      ],
      "secrets": [
        {
          "name": "FLY_TIGRIS_ACCESS_KEY",
          "env_var": "S3_ACCESS_KEY"
        },
        {
          "name": "FLY_TIGRIS_SECRET_ACCESS_KEY",
          "env_var": "S3_SECRET_KEY"
        },
        {
          "name": "FLY_TIGRIS_BUCKET",
          "env_var": "BUCKET_NAME"
        },
        {
          "name": "FLY_TIGRIS_ENDPOINT_URL",
          "env_var": "S3_ENDPOINT"
        },
        {
          "name": "FLY_TIGRIS_REGION",
          "env_var": "S3_REGION"
        }
      ],
      "restart": {
        "policy": "no"
      },
      "healthchecks": [
        {
          "type": "http",
          "http": {
            "ip": "127.0.0.1",
            "port": 9567,
            "method": "head",
            "path": "/metrics",
            "scheme": "http"
          },
          "failure_threshold": 5,
          "success_threshold": 1,
          "interval": 1,
          "grace_period": 0
        }
      ]
    },
    {
      "name": "app",
      "image": "docker.io/flyio/app-storage:latest",
      "entrypoint": [
        "/usr/local/bin/fly-user-env.sh"
      ],
      "env": {
        "FLYNET_CHANNEL_TOKEN": "XCP.XsUV5tW4BhBW00r2MHYSqRhV1Hd9c9u4IoH6r0ddj2nBZdtGi0TTGoRkfCyTaU4HfhX1cWe4ZNZRpcG6lLs7RjZcgHc_tXVgpfRKNkNk7YOcCpl6souEO624lD6zb76SGx4VhE0-g4v9Anm7NdJKhC0N8T2bC49J4T0AD3iA5774UVXgKxynwTMLMQ1StKOwcZHMBUAFPGJpyr9m-uyTdw38tO0p_wtTDhrYlppW2mHx1Yz34BWpzw",
        "FLYNET_CHANNEL_TOPIC": "ide:825",
        "FLYNET_CHANNEL_URI": "https://phoenix.new",
        "FLYNET_REPLAY_SECRET": "fBbPm4oKz6E3ev0S2Dv0jfFO3n4",
      },
      "files":[{
        "guest_path": "/etc/app-image.json",
        "image_config": "registry.fly.io/flynet-ide:deployment-01JT2EP6M8RFSYBEYXSC6H0KAH"
      }],
      "mounts": [
        {
          "name": "shared",
          "path": "/data"
        },
        {
          "name": "app-image",
          "path": "/mnt/app-image"
        }
      ],
      "depends_on": [
        {
          "name": "storage",
          "condition": "healthy"
        }
      ],
      "restart": {
        "policy": "always"
      }
    }
  ],
  "services": [
    {
      "protocol": "tcp",
      "internal_port": 7075,
      "ports": [
        {
          "port": 80,
          "handlers": [
            "http"
          ]
        },
        {
          "port": 443,
          "handlers": [
            "http",
            "tls"
          ]
        }
      ],
      "force_instance_key": null
    }
  ],
  "restart": {
    "policy": "no",
    "max_retries": 10
  },
  "stop_config": {
    "timeout": "30s",
    "signal": "SIGINT"
  },
  "volumes": [
    {
      "name": "shared",
      "temp_dir": {
        "size_mb": 100,
        "storage_type": "memory"
      }
    },
    {
      "name": "app-image",
      "image": "registry.fly.io/flynet-ide:deployment-01JT2EP6M8RFSYBEYXSC6H0KAH"
    }
  ]
}
