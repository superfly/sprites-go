{
  "guest": {
    "cpu_kind": "shared",
    "cpus": 4,
    "memory_mb": 4096
  },
  "mounts": [
    {
    "volume": "<volume_id>",
      "path": "/dev/fly_vol"
    }
  ],
  "image": "registry.fly.io/sprite-env-prime:ubuntu-s6-2", 
  "containers": [
    {
      "name": "sprite",
      "image": "<image_ref>",
      "entrypoint": ["tail", "-f", "/dev/null"],
      "command": ["/bin/bash"],
      "env": {},
      "secrets": [
        {
          "name": "SPRITE_S3_ACCESS_KEY",
          "env_var": "SPRITE_S3_ACCESS_KEY"
        },
        {
          "name": "SPRITE_S3_SECRET_ACCESS_KEY",
          "env_var": "SPRITE_S3_SECRET_ACCESS_KEY"
        },
        {
          "name": "SPRITE_S3_BUCKET",
          "env_var": "SPRITE_S3_BUCKET"
        },
        {
          "name": "SPRITE_S3_ENDPOINT_URL",
          "env_var": "SPRITE_S3_ENDPOINT_URL"
        },
        {
          "name": "SPRITE_S3_REGION",
          "env_var": "SPRITE_S3_REGION"
        }
      ],
      "files":[{
        "guest_path": "/etc/app-image.json",
        "image_config": "registry.fly.io/sprite-env-prime:ubuntu-s6-2"
      }],
      "mounts": [
        {
          "name": "shared",
          "path": "/data"
        },
        {
          "name": "app-image",
          "path": "/mnt/app-image"
        }
      ],
      "restart": {
        "policy": "no"
      }
    }
  ],
  "services": [
    {
      "protocol": "tcp",
      "internal_port": 7778,
      "ports": [
        {
          "port": 80,
          "handlers": [
            "http"
          ]
        },
        {
          "port": 443,
          "handlers": [
            "http",
            "tls"
          ]
        }
      ],
      "force_instance_key": null
    }
  ],
  "restart": {
    "policy": "no"
  },
  "stop_config": {
    "timeout": "30s",
    "signal": "SIGINT"
  },
  "volumes": [
    {
      "name": "shared",
      "temp_dir": {
        "size_mb": 100,
        "storage_type": "memory"
      }
    },
    {
      "name": "app-image",
      "image": "registry.fly.io/sprite-env-prime:ubuntu-s6-2"
    }
  ]
}
