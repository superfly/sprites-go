#!/bin/bash
# Sprite JavaScript SDK CLI wrapper

DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
NODE_VERSION=$(node --version 2>/dev/null | sed 's/v//' | cut -d. -f1)

if [ -z "$NODE_VERSION" ] || [ "$NODE_VERSION" -lt 18 ]; then
    echo "Error: Node.js 18 or higher is required" >&2
    exit 1
fi

# Build if dist doesn't exist
if [ ! -d "$DIR/dist" ]; then
    echo "Building TypeScript sources..." >&2
    cd "$DIR" && npm run build
fi

exec node "$DIR/dist/cli/sprite-cli.js" "$@"